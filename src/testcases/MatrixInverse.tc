⍝ MatrixInverse.tc
⍝ ----------------------------------

      R←3 3ρ1 0 0 0 2 0 2 0 4
      R
1 0 0
0 2 0
2 0 4

      Z←⌹R
      Z
 1   0   0
 0   0.5 0
¯0.5 0   0.25

      Z+.×R
1 0 0
0 1 0
0 0 1


      ⎕PP←4
      R←3 3ρ1 2 3 2 4 5 3 5 6
      R
1 2 3
2 4 5
3 5 6

      Z←⌹R
      ⌊Z + 1E¯12
 1 ¯3  2
¯3  3 ¯1
 2 ¯1  0

      0 4⍕R+.×Z
 1.0000  .0000  .0000
  .0000 1.0000  .0000
  .0000  .0000 1.0000

      ⎕PP←10

      ⍝ QR factorization
      ⍝
             B← 4J6 6J3 5J10 3J2 8J10 3J4 5J10 5J8 3J1 2J3
      B←5 4⍴ B, 4J5 1J3 1J4  9J9 9J6  2J7 2J10 7J6 9J8 10J10
      (QT R Rinv)←⌹[⎕CT]B

      0 4⍕QT
  .4107J¯.0310  .7219J¯.1180  .1338J¯.1213  .2271J.0623   .5538J.1806
  .0621J¯.1742 ¯.5950J.0697   .0880J.2603   .9071J.0968   .1779J¯.3283
  .9124J¯.1121 ¯.2629J.4735   .3667J¯.0282  .0575J.2496  ¯.6232J¯.3575
  .3710J.3755  ¯.7179J¯.4253 ¯.1833J.3784  ¯.5003J.2494   .8260J¯.3033
 ¯.2148J.0626  ¯.1979J.2738  1.0188J.0717  ¯.1208J¯.0703  .0605J¯.2291

      0 4⍕R   ⍝ R is upper triangular
 8.5870J15.2557 10.1036J10.9309 13.5055J18.7452 10.0961J15.2530
  .0000J.0000    8.7353J5.5589   9.2429J.4120    2.5086J.7539
  .0000J.0000     .0000J.0000   ¯2.4869J4.4115  ¯5.9788J¯6.0801
  .0000J.0000     .0000J.0000     .0000J.0000    7.4038J¯3.9492
  .0000J.0000     .0000J.0000     .0000J.0000     .0000J.0000

      0 4⍕QT +.× ⍉QT   ⍝ Q is orthogonal
 1.0000J.0000  .0000J.0000  .0000J.0000  .0000J.0000  .0000J.0000
  .0000J.0000 1.0000J.0000  .0000J.0000  .0000J.0000  .0000J.0000
  .0000J.0000  .0000J.0000 1.0000J.0000  .0000J.0000  .0000J.0000
  .0000J.0000  .0000J.0000  .0000J.0000 1.0000J.0000  .0000J.0000
  .0000J.0000  .0000J.0000  .0000J.0000  .0000J.0000 1.0000J.0000

      0 4⍕ B - (⍉QT) +.× R   ⍝ B is (⍉QT) +.× R
 .0000J.0000 .0000J.0000 .0000J.0000 .0000J.0000
 .0000J.0000 .0000J.0000 .0000J.0000 .0000J.0000
 .0000J.0000 .0000J.0000 .0000J.0000 .0000J.0000
 .0000J.0000 .0000J.0000 .0000J.0000 .0000J.0000
 .0000J.0000 .0000J.0000 .0000J.0000 .0000J.0000

⍝ ==================================
      0 4⍕ Rinv +.× R   ⍝ Rinv is the inverse of R
 1.0000J.0000  .0000J.0000  .0000J.0000  .0000J.0000
  .0000J.0000 1.0000J.0000  .0000J.0000  .0000J.0000
  .0000J.0000  .0000J.0000 1.0000J.0000  .0000J.0000
  .0000J.0000  .0000J.0000  .0000J.0000 1.0000J.0000

