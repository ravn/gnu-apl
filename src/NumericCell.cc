/*
    This file is part of GNU APL, a free implementation of the
    ISO/IEC Standard 13751, "Programming Language APL, Extended"

    Copyright (C) 2008-2013  Dr. JÃ¼rgen Sauermann

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

#include <errno.h>
#include <fenv.h>
#include <math.h>

#include "Workspace.hh"
#include "Value.icc"
#include "Error.hh"
#include "ComplexCell.hh"
#include "FloatCell.hh"
#include "IntCell.hh"

//-----------------------------------------------------------------------------
ErrorCode
NumericCell::bif_not(Cell * Z) const
{
const APL_Float qct = Workspace::get_CT();

   if (!is_near_bool(qct))   return E_DOMAIN_ERROR;

   if (get_near_bool(Workspace::get_CT()))   new (Z) IntCell(0);
   else                                      new (Z) IntCell(1);
   return E_NO_ERROR;
}
//-----------------------------------------------------------------------------

const uint64_t binom_K_8[] = { (887), 1, 9, 45, 165, 495, 1287, 3003, 6435,
 12870, 24310, 43758, 75582, 125970, 203490, 319770, 490314, 735471, 1081575,
 1562275, 2220075, 3108105, 4292145, 5852925, 7888725, 10518300, 13884156,
 18156204, 23535820, 30260340, 38608020, 48903492, 61523748, 76904685,
 95548245, 118030185, 145008513, 177232627, 215553195, 260932815, 314457495,
 377348994, 450978066, 536878650, 636763050, 752538150, 886322710,
 1040465790, 1217566350, 1420494075, 1652411475, 1916797311, 2217471399,
 2558620845, 2944827765, 3381098545, 3872894697, 4426165368, 5047381560,
 5743572120, 6522361560, 7392009768, 8361453672, 9440350920, 10639125640,
 11969016345, 13442126049, 15071474661, 16871053725, 18855883575,
 21042072975, 23446881315, 26088783435, 28987537150, 32164253550,
 35641470150, 39443226966, 43595145594, 48124511370, 53060358690,
 58433559570, 64276915527, 70625252863, 77515521435, 84986896995,
 93080887185, 101841441273, 111315063717, 121550931645, 132601016340,
 144520208820, 157366449604, 171200862756, 186087894300, 202095455100,
 219295068300, 237762021420, 257575523205, 278818865325, 301579589025,
 325949656825, 352025629371, 379908847539, 409705619895, 441527415615,
 475491062970, 511718953482, 550339251858, 591486111810, 635299897870,
 681927413310, 731522134278, 784244450262, 840261910995, 899749479915,
 962889794295, 1029873432159, 1100899186101, 1176174344125, 1255914977625,
 1340346236625, 1429702652400, 1524228447600, 1624177854000, 1729815438000,
 1841416434000, 1959267085776, 2083664995984, 2214919483920, 2353351951665,
 2499296258745, 2653099105437, 2815120424853, 2985733783935, 3165326793495,
 3354301527435, 3553074951283, 3762079360182, 3981762826470, 4212589656990,
 4455040860270, 4709614623714, 4976826800946, 5257211409450, 5551321138650,
 5859727868575, 6183023199255, 6521818990995, 6876747915675, 7248464019225,
 7637643295425, 8044984271181, 8471208603429, 8917061687820, 9383313279340,
 9870758125020, 10380216608892, 10912535409348, 11468588169060,
 12049276177620, 12655529067060, 13288305520413, 13948593993477,
 14637413449945, 15355814110065, 16104878212995, 16885720793019,
 17699490469791, 18547370252775, 19430578360050, 20350369051650,
 21308033477610, 22304900540890, 23342337775350, 24421752238950,
 25544591422350, 26712344173086, 27926541635499, 29188758206595,
 30500612508015, 31863768374295, 33279935857597, 34750872249093,
 36278383117185, 37864323362745, 39510598291560, 41219164704168,
 42992032003272, 44831263318920, 46738976651640, 48717346033720,
 50768602708824, 52895036330136, 55098996177225, 57382892391825,
 59749197232725, 62200446349965, 64739240078535, 67368244751775,
 70090194034675, 72907890277275, 75824205888366, 78842084729694,
 81964543530870, 85194673325190, 88535640906570, 91990690307802,
 95563144300338, 99256405915810, 103073959989495, 107019374725935,
 111096303286923, 115308485402067, 119659749002145, 124154011875465,
 128795283347445, 133587665983629, 138535357316356, 143642651595300,
 148913941562100, 154353720249300, 159966582803820, 165757228335180,
 171730461788700, 177891195843900, 184244452838325, 190795366717021,
 197549185007889, 204511270823145, 211687104887115, 219082287590595,
 226702541072007, 234553711325583, 242641770336810, 250972818245370,
 259553085535810, 268388935256178, 277486865264862, 286853510505870,
 296495645312790, 306420185741670, 316634191933059, 327144870503451,
 337959576966375, 349085818183375, 360531254845125, 372303703982925,
 384411141510825, 396861704798625, 409663695276000, 422825581068000,
 436355999662176, 450263760607584, 464557848245920, 479247424475040,
 494341831545120, 509850594887712, 525783425977953, 542150225230185,
 558961084927245, 576226292183685, 593956331943183, 612161890010407,
 630853856117595, 650043327026115, 669741609663270, 689960224294614,
 710710907732046, 732005616577950, 753856530505650, 776276055576450,
 799276827593530, 822871715492970, 847073824772175, 871896500955975,
 897353333100675, 923458157336331, 950225060447529, 977668383492945,
 1005802725463965, 1034642946982645, 1064204174039292, 1094501801769948,
 1125551498274060, 1157369208472620, 1189971158007060, 1223373857179188,
 1257594104932452, 1292648992874820, 1328555909343565, 1365332543512245,
 1402996889540169, 1441567250764641, 1481062243936275, 1521500803497675,
 1562902185905775, 1605285973998135, 1648672081403490, 1693080756996850,
 1738532589399450, 1785048511523850, 1832649805164486, 1881358105633974,
 1931195406445470, 1982184064041390, 2034346802568795, 2087706718701747,
 2142287286510943, 2198112362380935, 2255206189975245, 2313593405249685,
 2373299041514193, 2434348534543497, 2496767727736920, 2560582877327640,
 2625820657641720, 2692508166407224, 2760672930113736, 2830342909422600,
 2901546504628200, 2974312561170600, 3048670375199865, 3124649699192385,
 3202280747619525, 3281594202668925, 3362621220018775, 3445393434665391,
 3529942966804419, 3616302427765995, 3704504926004190, 3794584073141070,
 3886573990065702, 3980509313088438, 4076425200150810, 4174357337091370,
 4274341943967810, 4376415781435698, 4480616157184167, 4586980932428895,
 4695548528462715, 4806357933264195, 4919448708164529, 5034860994573081,
 5152635520761925, 5272813608709725, 5395437181005300, 5520548767811220,
 5648191513887780, 5778409185677700, 5911246178451900, 6046747523516700,
 6184958895482796, 6325926619596364, 6469697679132645, 6616319722852365,
 6765841072521345, 6918310730493657, 7073778387358683, 7232294429652435,
 7393909947633495, 7558676743123935, 7726647337415578, 7897874979241962,
 8072413652816370, 8250318085936290, 8431643758154670, 8616446909018334,
 8804784546373926, 8996714454741750, 9192295203757875, 9391586156684875,
 9594647478991575, 9801540147002175, 10012325956615125, 10227067532092125,
 10445828334917625, 10668672672729201, 10895665708319184, 11126873468707920,
 11362362854289040, 11602201648047120, 11846458524848112, 12095203060802928,
 12348505742704560, 12606437977539120, 12869072102071185, 13136481392503833,
 13408740074213757, 13685923331561845, 13968107317779615, 14255369164931895,
 14547786993956139, 14845439924778771, 15148408086508950, 15456772627710150,
 15770615726749950, 16090020602228430, 16415071523485570, 16745853821188050,
 17082453897995850, 17424959239309050, 17773458424095231, 18128041135797879,
 18488798173326195, 18855821462126715, 19229204065337145, 19609040195022817,
 19995425223496173, 20388455694719685, 20788229335792620, 21194845068522060,
 21608403021078588, 22029004539737052, 22456752200702820, 22891749822023940,
 23334102475589620, 23783916499215444, 24241299508815741, 24706360410663525,
 25179209413738425, 25659958042163025, 26148719147728035, 26645606922506715,
 27150736911558975, 27664226025725575, 28186192554512850, 28716756179068386,
 29256037985248074, 29804160476774970, 30361247588490390, 30927424699697670,
 31502818647599022, 32087557740825918, 32681771773063435, 33285592036768995,
 33899151336985935, 34522584005252343, 35156025913605597, 35799614488683045,
 36453488725919265, 37117789203840345, 37792658098455624, 38478239197747336,
 39174677916258600, 39882121309780200, 40600718090136600, 41330618640071640,
 42071975028234360, 42824941024265400, 43589672113984425, 44366325514679025,
 45155060190495541, 45956036867932269, 46769418051435495, 47595368039098815,
 48434052938466195, 49285640682439227, 50150301045289038, 51028205658773310,
 51919528028358870, 52824443549550310, 53743129524325098, 54675765177675642,
 55622531674258770, 56583612135153090, 57559191654724695, 58549457317601679,
 59554598215757931, 60574805465706675, 61610272225804225, 62661193713664425,
 63727767223684245, 64810192144681005, 65908669977641700, 67023404353584900,
 68154601051535700, 69302468016614196, 70467215378237964, 71649055468439020,
 72848202840295740, 74064874286480220, 75299288857921557, 76551667882585533,
 77822234984371185, 79111216102124745, 80418839508771435, 81745335830565603,
 83090938066459687, 84455881607592495, 85840404256897290, 87244746248830170,
 88669150269219234, 90113861475235026, 91579127515482750, 93065198550216750,
 94572327271677750, 96100768924553350, 97650781326562275, 99222624889162875,
 100816562638386375, 102432860235795375, 104071785999568101,
 105733610925708909, 107418608709385545, 109127055766393665,
 110859231254749120, 112615417096408512, 114395897999118528,
 116200961478394560, 118030897879629120, 119886000400330560,
 121766565112492608, 123672890985095232, 125605279906737345,
 127564036708401865, 129549469186353645, 131561888125170789,
 133601607320909871, 135668943604405575, 137764216864705275,
 139887750072639075, 142039869304525830, 144220903766015670,
 146431185816069550, 148671050991076350, 150940838029108050,
 153240888894313506, 155571548801451354, 157933166240562570,
 160326093001783215, 162750684200297895, 165207298301434467,
 167696297145900523, 170218045975162185, 172772913456965745,
 175361271711002685, 177983496334718613, 180639966429266652,
 183331064625605820, 186057177110744940, 188818693654132620,
 191616007634193844, 194449516065013716, 197319619623168900,
 200226722674707300, 203171233302276525, 206153563332401685,
 209174128362913065, 212233347790524225, 215331644838561075,
 218469446584842475, 221647183989712911, 224865291924227799,
 228124209198491970, 231424378590151890, 234766246873042170,
 238150264845986922, 241576887361756518, 245046573356180310,
 248559785877415870, 252116992115375310, 255718663431309243,
 259365275387548947, 263057307777407295, 266795244655239015,
 270579574366660845, 274410789578932149, 278289387311496561,
 282215868966685225, 286190740360582200, 290214511754052600,
 294287697883934040, 298410817994391960, 302584395868439400,
 306808959859621800, 311085042923867400, 315413182651503816,
 319793921299441369, 324227805823523745, 328715387911046565,
 333257224013444445, 337853875379147127, 342505908086605263,
 347213893077486435, 351978406190041995, 356800028192645310,
 361679344817501998, 366616946794532742, 371613429885429270,
 376669394917884090, 381785447819994570, 386962199654841954,
 392200266655245906, 397500270258695175, 402862837142454975,
 408288599258851675, 413778193870735395, 419332263587121105,
 424951456399008825, 430636425715383525, 436387830399395325,
 442206334804720596, 448092608812104564, 454047327866086020,
 460071173011904740, 466164830932592220, 472328993986246332,
 478564360243490508, 484871633525118060, 491251523439922245,
 497704745422712685, 504232020772518753, 510834076690980537,
 517511646320927995, 524265468785148915, 531096289225346295,
 538004858841285759, 544991934930133626, 552058280925986250,
 559204666439591250, 566431867298261250, 573740665585980750,
 581131849683706750, 588606214309863750, 596164560561033750,
 603807695952841875, 611536434461038251, 619351596562776759,
 627254009278091295, 635244506211570165, 643323927594229245,
 651493120325584537, 659752938015924753, 668104241028784560,
 676547896523619120, 685084778498680560, 693715767834097008,
 702441752335154832, 711263626775784720, 720182292942252240,
 729198659677053520, 738313642923016689, 747528165767609721,
 756843158487455325, 766259558593053525, 775778310873712575,
 785400367442688855, 795126687782536395, 804958238790666675,
 814895994825119350, 824940937750544550, 835094056984397406,
 845356349543345454, 855728820089889570, 866212480979199090,
 876808352306161770, 887517461952649242, 898340845634998623,
 909279546951710935, 920334617431366995, 931507116580761435,
 942798111933255513, 954208679097349377, 965739901805474445,
 977392871963006565, 989168689697500620, 1001068463408147244,
 1013093309815452316, 1025244354011139900, 1037522729508279300,
 1049929578291636900, 1062466050868253460, 1075133306318247540,
 1087932512345845725, 1100864845330640325, 1113931490379075225,
 1127133641376160561, 1140472501037416899, 1153949280961049595,
 1167565201680354015, 1181321492716352295, 1195219392630662322,
 1209260149078599618, 1223445018862512810, 1237775267985353370,
 1252252171704480310, 1266877014585700518, 1281651090557545422,
 1296575702965784670, 1311652164628177515, 1326881797889462595,
 1342265934676586799, 1357805916554173911, 1373503094780233725,
 1389358830362112325, 1405374494112684225, 1421551466706787065,
 1437891138737899560, 1454394910775063400, 1471064193420049800,
 1487900407364771400, 1504904983448940216, 1522079362717972344,
 1539424996481140120, 1556943346369972440, 1574635884396903945,
 1592504093014173777, 1610549465172974613, 1628773504382852685,
 1647177724771359495, 1665763651143955935, 1684532819044169523,
 1703486774814005467, 1722627075654612270, 1741955289687202590,
 1761472996014230070, 1781181784780822854, 1801083257236474506,
 1821179025796993050, 1841470714106708850, 1861959957100942050,
 1882648401068730295, 1903537703715817455, 1924629534227904075,
 1945925573334160275, 1967427513371001825, 1989137058346130121,
 2011055924002836789, 2033185837884573645, 2055528539399788740,
 2078085779887029220, 2100859322680311732, 2123850943174761108,
 2147062428892518060, 2170495579548916620, 2194152207118932060,
 2218034135903900028, 2242143202598507637, 2266481256358057245,
 2291050158866003665, 2315851784401765545, 2340888019908811659,
 2366160765063022851, 2391671932341330375, 2417423447090631375,
 2443417247596982250, 2469655285155070650, 2496139524137966850,
 2522871942067155250, 2549854529682846750, 2577089291014572750,
 2604578243452061526, 2632323417816397734, 2660326858431465795,
 2688590623195677915, 2717116783653987495, 2745907425070188687,
 2774964646499502853, 2804290560861452685, 2833887295013024745,
 2863756989822121185, 2893901800241301408, 2924323895381814432,
 2955025458587922720, 2986008687511518240, 3017275794187031520,
 3048829005106634464, 3080670561295737696, 3112802718388783200,
 3145227746705333025, 3177947931326454825, 3210965572171405005,
 3244282984074610245, 3277902496862948175, 3311826455433327975,
 3346057219830571675, 3380597165325596931, 3415448682493902054,
 3450614177294354070, 3486096071148280590, 3521896801018866270,
 3558018819490854642, 3594464594850556098, 3631236611166162810,
 3668337368368371370, 3705769382331313935, 3743535184953798663,
 3781637324240860227, 3820078364385621195, 3858860885851465065,
 3897987485454521745, 3937460776446466269, 3977283388597631541,
 4017457968280435900, 4057987178553126300, 4098873699243837900,
 4140120227034970860, 4181729475547885140, 4223704175427914100,
 4266047074429697700, 4308760937502836100, 4351848546877864461,
 4395312702152549749, 4439156220378510345, 4483381936148159265,
 4527992701681971795, 4572991386916078347, 4618380879590183343,
 4664164085335810935, 4710343927764878370, 4756923348558597810,
 4803905307556707418, 4851292782847032522, 4899088770855377670,
 4947296286435750390, 4995918362960917470, 5044958052413294574,
 5094418425476170011, 5144302571625263475, 5194613599220620575,
 5245354635598843975, 5296528827165661965, 5348139339488835285,
 5400189357391403025, 5452682085045268425, 5505620746065125400,
 5559008583602726616, 5612848860441493944, 5667144859091472120,
 5721899881884626440, 5777117251070485320, 5832800308912128552,
 5888952417782522088, 5945576960261200185, 6002677339231295745,
 6060256977976919685, 6118319320280890173, 6176867830522812567,
 6235905993777510895, 6295437315913811715, 6355465323693681195,
 6415993564871716254, 6477025608294990606, 6538565044003256550,
 6600615483329503350, 6663180559000873050, 6726263925239934570,
 6789869257866316930, 6854000254398702450, 6918660634157180775,
 6983854138365964575, 7049584530256467771, 7115855595170747139,
 7182671140665308145, 7250034996615275865, 7317951015318931845,
 7386423071602617757, 7455455062926006708, 7525050909487743060,
 7595214554331451620, 7665949963452117060, 7737261125902834428,
 7809152053901931612, 7881626782940464620, 7954689371890086540,
 8028343903111291045, 8102594482562031309, 8177445239906715201,
 8252900328625577625, 8328963926124430875, 8405640233844793875,
 8482933477374401175, 8560847906558092575, 8639387795609084250,
 8718557443220622250, 8798361172678019250, 8878803331971075426,
 8959888293906884334, 9041620456223024670, 9124004241701138790,
 9207044098280898870,
};
const uint64_t binom_K_9[] = { (534), 1, 10, 55, 220, 715, 2002, 5005, 11440,
 24310, 48620, 92378, 167960, 293930, 497420, 817190, 1307504, 2042975,
 3124550, 4686825, 6906900, 10015005, 14307150, 20160075, 28048800, 38567100,
 52451256, 70607460, 94143280, 124403620, 163011640, 211915132, 273438880,
 350343565, 445891810, 563921995, 708930508, 886163135, 1101716330,
 1362649145, 1677106640, 2054455634, 2505433700, 3042312350, 3679075400,
 4431613550, 5317936260, 6358402050, 7575968400, 8996462475, 10648873950,
 12565671261, 14783142660, 17341763505, 20286591270, 23667689815,
 27540584512, 31966749880, 37014131440, 42757703560, 49280065120,
 56672074888, 65033528560, 74473879480, 85113005120, 97082021465,
 110524147514, 125595622175, 142466675900, 161322559475, 182364632450,
 205811513765, 231900297200, 260887834350, 293052087900, 328693558050,
 368136785016, 411731930610, 459856441980, 512916800670, 571350360240,
 635627275767, 706252528630, 783768050065, 868754947060, 961835834245,
 1063677275518, 1174992339235, 1296543270880, 1429144287220, 1573664496040,
 1731030945644, 1902231808400, 2088319702700, 2290415157800, 2509710226100,
 2747472247520, 3005047770725, 3283866636050, 3585446225075, 3911395881900,
 4263421511271, 4643330358810, 5053035978705, 5494563394320, 5970054457290,
 6481773410772, 7032112662630, 7623598774440, 8258898672310, 8940826085620,
 9672348219898, 10456592670160, 11296854581155, 12196604061070,
 13159493855365, 14189367287524, 15290266473625, 16466440817750,
 17722355795375, 19062702032000, 20492404684400, 22016633132000,
 23640810986000, 25370626424000, 27212042858000, 29171309943776,
 31254974939760, 33469894423680, 35823246375345, 38322542634090,
 40975641739527, 43790762164380, 46776495948315, 49941822741810,
 53296124269245, 56849199220528, 60611278580710, 64593041407180,
 68805631064170, 73260671924440, 77970286548154, 82947113349100,
 88204324758550, 93755645897200, 99615373765775, 105798396965030,
 112320215956025, 119196963871700, 126445427890925, 134083071186350,
 142128055457531, 150599264060960, 159516325748780, 168899639028120,
 178770397153140, 189150613762032, 200063149171380, 211531737340440,
 223581013518060, 236236542585120, 249524848105533, 263473442099010,
 278110855548955, 293466669659020, 309571547872015, 326457268665034,
 344156759134825, 362704129387600, 382134707747650, 402485076799300,
 423793110276910, 446098010817800, 469440348593150, 493862100832100,
 519406692254450, 546119036427536, 574045578063035, 603234336269630,
 633734948777645, 665598717151940, 698878653009537, 733629525258630,
 769907908375815, 807772231738560, 847282830030120, 888501994734288,
 931494026737560, 976325290056480, 1023064266708120, 1071781612741840,
 1122550215450664, 1175445251780800, 1230544247958025, 1287927140349850,
 1347676337582575, 1409876783932540, 1474616024011075, 1541984268762850,
 1612074462797525, 1684982353074800, 1760806558963166, 1839648643692860,
 1921613187223730, 2006807860548920, 2095343501455490, 2187334191763292,
 2282897336063630, 2382153741979440, 2485227701968935, 2592247076694870,
 2703343379981793, 2818651865383860, 2938311614386005, 3062465626261470,
 3191260909608915, 3324848575592544, 3463383932908900, 3607026584504200,
 3755940526066300, 3910294246315600, 4070260829119420, 4236018057454600,
 4407748519243300, 4585639715087200, 4769884167925525, 4960679534642546,
 5158228719650435, 5362739990473580, 5574427095360695, 5793509382951290,
 6020211924023297, 6254765635348880, 6497407405685690, 6748380223931060,
 7007933309466870, 7276322244723048, 7553809109987910, 7840662620493780,
 8137158265806570, 8443578451548240, 8760212643481299, 9087357513984750,
 9425317090951125, 9774402909134500, 10134934163979625, 10507237867962550,
 10891649009473375, 11288510714272000, 11698174409548000, 12120999990616000,
 12557355990278176, 13007619750885760, 13472177599131680, 13951425023606720,
 14445766855151840, 14955617450039552, 15481400876017505, 16023551101247690,
 16582512186174935, 17158738478358620, 17752694810301803, 18364856700312210,
 18995710556429805, 19645753883455920, 20315495493119190, 21005455717413804,
 21716166625145850, 22448172241723800, 23202028772229450, 23978304827805900,
 24777581655399430, 25600453370892400, 26447527195664575, 27319423696620550,
 28216777029721225, 29140235187057556, 30090460247505085, 31068128630998030,
 32073931356461995, 33108574303444640, 34172778477483932, 35267280279253880,
 36392831777527940, 37550200986000560, 38740172144007620, 39963546001186808,
 41221140106119260, 42513789098994080, 43842345008337645, 45207677551849890,
 46610674441390059, 48052241692154700, 49533303936090975, 51054804739588650,
 52617706925494425, 54222992899492560, 55871664980896050, 57564745737892900,
 59303278327292350, 61088326838816200, 62920976643980686, 64802334749614660,
 66733530156060130, 68715714220101520, 70750061022670315, 72837767741372062,
 74980055027883005, 77178167390263940, 79433373580239185, 81746966985488870,
 84120266027003063, 86554614561546560, 89051382289283480, 91611965166611120,
 94237785824252840, 96930293990660064, 99690966920773800, 102521309830196400,
 105422856334824600, 108397168895995200, 111445839271195065,
 114570488970387450, 117772769718006975, 121054363920675900,
 124416985140694675, 127862378575360066, 131392321542164485,
 135008623969930480, 138713128895934670, 142507712969075740,
 146394286959141442, 150374796272229880, 154451221472380690,
 158625578809472060, 162899920753439870, 167276336534875568,
 171756952692059735, 176343933624488630, 181039482152951345,
 185845840086215540, 190765288794380069, 195800149788953150,
 200952785309715075, 206225598918424800, 211621036099430100,
 217141584867241320, 222789776381129100, 228568185566806800,
 234479431745258700, 240526179268775400, 246711138164258196,
 253037064783854560, 259506762462987205, 266123082185839570,
 272888923258360915, 279807233988854572, 286881012376213255,
 294113306805865690, 301507216753499185, 309065893496623120,
 316792540834038698, 324690415813280660, 332762829466097030,
 341013147552033320, 349444791310187990, 358061238219206324,
 366866022765580250, 375862737220322000, 385055032424079875,
 394446618580764750, 404041266059756325, 413842806206758500,
 423855132163373625, 434082199695465750, 444528028030383375,
 455196700703112576, 466092366411431760, 477219239880139680,
 488581602734428720, 500183804382475840, 512030262907323952,
 524125465968126880, 536473971710831440, 549080409688370560,
 561949481790441745, 575085963182945578, 588494703257159335,
 602180626588721180, 616148733906500795, 630404103071432690,
 644951890065388829, 659797329990167600, 674945738076676550,
 690402510704386700, 706173126431136650, 722263147033365080,
 738678218556850650, 755424072378038700, 772506526276034550,
 789931485515343600, 807704943939438831, 825832985075236710,
 844321783248562905, 863177604710689620, 882406808776026765,
 902015848971049582, 922011274194545755, 942399729889265440,
 963187959225058060, 984382804293580120, 1005991207314658708,
 1028020211854395760, 1050476964055098580, 1073368713877122520,
 1096702816352712140, 1120486732851927584, 1144728032360743325,
 1169434392771406850, 1194613602185145275, 1220273560227308300,
 1246422279375036335, 1273067886297543050, 1300218623209102025,
 1327882849234827600, 1356069041789340450, 1384785797968408836,
 1414041835953656910, 1443845996430431880, 1474207244018922270,
 1505134668718619940, 1536637487366218962, 1568725045107044880,
 1601406816880108315, 1634692408916877310, 1668591560253863245,
 1703114144259115588, 1738270170172721185, 1774069784661404230,
 1810523273387323495, 1847641062591163840, 1885433720689619464,
 1923911959887366800, 1963086637803625400, 2002968759113405600,
 2043569477203542200, 2084900095843613840, 2126972070871848200,
 2169797011896113600, 2213386684010098025, 2257753009524777050,
 2302908069715272591, 2348864106583204860, 2395633524634640355,
 2443228892673739170, 2491662945612205365, 2540948586294644592,
 2591098887339933630, 2642127092998706940, 2694046621027065810,
 2746871064576616120, 2800614194100941218, 2855289959278616860,
 2910912490952875630, 2967496103088028720, 3025055294742753415,
 3083604752060355094, 3143159350276113025, 3203734155741819700,
 3265344427967623925, 3328005621681288350, 3391733388904972595,
 3456543581049653600, 3522452251027295300, 3589475655380880200,
 3657630256432415900, 3726932724449030096, 3797399939827268060,
 3869048995295707080, 3941897198136002820, 4015962072422483040,
 4091261361280404597, 4167813029162990130, 4245635264147361315,
 4324746480249486060, 4405165319758257495, 4486910655588823098,
 4570001593655282785, 4654457475262875280, 4740297879519772570,
 4827542625768602740, 4916211776037821974, 5006325637513057000,
 5097904765028539750, 5190969963578756500, 5285542290850434250,
 5381643059774987600, 5479293841101549875, 5578516465990712750,
 5679333028629099125, 5781765888864894500, 5885837674864462601,
 5991571285790171510, 6098989894499557055, 6208116950265950720,
 6318976181520699840, 6431591598617108352, 6545987496616226880,
 6662188458094621440, 6780219355974250560, 6900105356374581120,
 7021871921487073728, 7145544812472168960, 7271150092378906305,
 7398714129087308170, 7528263598273661815, 7659825486398832604,
 7793427093719742475, 7929096037324148050, 8066860254188853325,
 8206748004261492400, 8348787873566018230, 8493008777332033900,
 8639439963148103450, 8788111014139179800, 8939051852168287850,
 9092292741062601356,
};
const uint64_t binom_K_10[] = { (361), 1, 11, 66, 286, 1001, 3003, 8008,
 19448, 43758, 92378, 184756, 352716, 646646, 1144066, 1961256, 3268760,
 5311735, 8436285, 13123110, 20030010, 30045015, 44352165, 64512240,
 92561040, 131128140, 183579396, 254186856, 348330136, 472733756, 635745396,
 847660528, 1121099408, 1471442973, 1917334783, 2481256778, 3190187286,
 4076350421, 5178066751, 6540715896, 8217822536, 10272278170, 12777711870,
 15820024220, 19499099620, 23930713170, 29248649430, 35607051480,
 43183019880, 52179482355, 62828356305, 75394027566, 90177170226,
 107518933731, 127805525001, 151473214816, 179013799328, 210980549208,
 247994680648, 290752384208, 340032449328, 396704524216, 461738052776,
 536211932256, 621324937376, 718406958841, 828931106355, 954526728530,
 1096993404430, 1258315963905, 1440680596355, 1646492110120, 1878392407320,
 2139280241670, 2432332329570, 2761025887620, 3129162672636, 3540894603246,
 4000751045226, 4513667845896, 5085018206136, 5720645481903, 6426898010533,
 7210666060598, 8079421007658, 9041256841903, 10104934117421, 11279926456656,
 12576469727536, 14005614014756, 15579278510796, 17310309456440,
 19212541264840, 21300860967540, 23591276125340, 26100986351440,
 28848458598960, 31853506369685, 35137373005735, 38722819230810,
 42634215112710, 46897636623981, 51540966982791, 56594002961496,
 62088566355816, 68058620813106, 74540394223878, 81572506886508,
 89196105660948, 97455004333258, 106395830418878, 116068178638776,
 126524771308936, 137821625890091, 150018229951161, 163177723806526,
 177367091094050, 192657357567675, 209123798385425, 226846154180800,
 245908856212800, 266401260897200, 288417894029200, 312058705015200,
 337429331439200, 364641374297200, 393812684240976, 425067659180736,
 458537553604416, 494360799979761, 532683342613851, 573658984353378,
 617449746517758, 664226242466073, 714168065207883, 767464189477128,
 824313388697656, 884924667278366, 949517708685546, 1018323339749716,
 1091584011674156, 1169554298222310, 1252501411571410, 1340705736329960,
 1434461382227160, 1534076755992935, 1639875152957965, 1752195368913990,
 1871392332785690, 1997837760676615, 2131920831862965, 2274048887320496,
 2424648151381456, 2584164477130236, 2753064116158356, 2931834513311496,
 3120985127073528, 3321048276244908, 3532580013585348, 3756161027103408,
 3992397569688528, 4241922417794061, 4505395859893071, 4783506715442026,
 5076973385101046, 5386544932973061, 5713002201638095, 6057158960772920,
 6419863090160520, 6801997797908170, 7204482874707470, 7628275984984380,
 8074373995802180, 8543814344395330, 9037676445227430, 9557083137481880,
 10103202173909416, 10677247751972451, 11280482088242081, 11914217037019726,
 12579815754171666, 13278694407181203, 14012323932439833, 14782231840815648,
 15590004072554208, 16437286902584328, 17325788897318616, 18257282924056176,
 19233608214112656, 20256672480820776, 21328454093562616, 22451004309013280,
 23626449560794080, 24856993808752105, 26144920949101955, 27492597286684530,
 28902474070617070, 30377090094628145, 31919074363390995, 33531148826188520,
 35216131179263320, 36976937738226486, 38816586381919346, 40738199569143076,
 42745007429691996, 44840350931147486, 47027685122910778, 49310582458974408,
 51692736200953848, 54177963902922783, 56770210979617653, 59473554359599446,
 62292206224983306, 65230517839369311, 68292983465630781, 71484244375239696,
 74809092950832240, 78272476883741140, 81879503468245340, 85635443994311640,
 89545738240627240, 93615999069746660, 97852017127201260, 102259765646444560,
 106845405361531760, 111615289529457285, 116575969064099831,
 121734197783750266, 127096937774223846, 132671364869584541,
 138464874252535831, 144485086176559128, 150739851811908008,
 157237259217593698, 163985639441524758, 170993572750991628,
 178269894995714676, 185823704105702586, 193664366726196366,
 201801524992002936, 210245103443551176, 219005316087032475,
 228092673601017225, 237517990691968350, 247292393601102850,
 257427327765082475, 267934565633045025, 278826214642518400,
 290114725356790400, 301812899766338400, 313933899756954400,
 326491255747232576, 339498875498118336, 352971053097250016,
 366922478120856736, 381368244976008576, 396323862426048128,
 411805263302065633, 427828814403313323, 444411326589488258,
 461570065067846878, 479322759878148681, 497687616578460891,
 516683327134890696, 536329081018346616, 556644576511465806,
 577650032228879610, 599366198854025460, 621814371095749260,
 645016399867978710, 668994704695784610, 693772286351184040,
 719372739722076440, 745820266917741015, 773139690614361565,
 801356467644082790, 830496702831140346, 860587163078645431,
 891655291709643461, 923729223066105456, 956837797369550096,
 991010575847034028, 1026277856126287908, 1062670687903815848,
 1100220888889816408, 1138961061033824028, 1178924607035010836,
 1220145747141130096, 1262659536240124176, 1306501881248461821,
 1351709558800311711, 1398320233241701770, 1446372474933856470,
 1495905778869947445, 1546960583609536095, 1599578290535030520,
 1653801283434523080, 1709672948415419130, 1767237694153312030,
 1826540972480604380, 1887629299319420580, 1950550275963401266,
 2015352610713015926, 2082086140869076056, 2150801855089177576,
 2221551916111847891, 2294389683853219953, 2369369738881102958,
 2446547906271366898, 2525981279851606083, 2607728246837094953,
 2691848512864098016, 2778403127425644576, 2867454509714928056,
 2959066474881539176, 3053304260705792016, 3150234554696452080,
 3249925521617225880, 3352446831447422280, 3457869687782246880,
 3566266856678242080, 3677712695949437145, 3792283184919824595,
 3910055954637831570, 4031110318558507470, 4155527303699202145,
 4283389682274562211, 4414782003816726696, 4549790627786657176,
 4688503756682591846, 4831011469651667586, 4977405756610809028,
 5127780552883038908, 5282231774355419598, 5440857353164891658,
 5603757273918331528, 5771033610453207096, 5942790563145266831,
 6119134496769755461, 6300173978922706806, 6486019819008922346,
 6676785107803302415, 6872585257592255565, 7073538042901970640,
 7279763641820395440, 7491384677919825540, 7708526262787066860,
 7931316039168195960, 8159884224735002760, 8394363656480261460,
 8634889835749036860, 8881600973913295056, 9134638038697149616,
};
const uint64_t binom_K_11[] = { (265), 1, 12, 78, 364, 1365, 4368, 12376,
 31824, 75582, 167960, 352716, 705432, 1352078, 2496144, 4457400, 7726160,
 13037895, 21474180, 34597290, 54627300, 84672315, 129024480, 193536720,
 286097760, 417225900, 600805296, 854992152, 1203322288, 1676056044,
 2311801440, 3159461968, 4280561376, 5752004349, 7669339132, 10150595910,
 13340783196, 17417133617, 22595200368, 29135916264, 37353738800,
 47626016970, 60403728840, 76223753060, 95722852680, 119653565850,
 148902215280, 184509266760, 227692286640, 279871768995, 342700125300,
 418094152866, 508271323092, 615790256823, 743595781824, 895068996640,
 1074082795968, 1285063345176, 1533058025824, 1823810410032, 2163842859360,
 2560547383576, 3022285436352, 3558497368608, 4179822305984, 4898229264825,
 5727160371180, 6681687099710, 7778680504140, 9036996468045, 10477677064400,
 12124169174520, 14002561581840, 16141841823510, 18574174153080,
 21335200040700, 24464362713336, 28005257316582, 32006008361808,
 36519676207704, 41604694413840, 47325339895743, 53752237906276,
 60962903966874, 69042324974532, 78083581816435, 88188515933856,
 99468442390512, 112044912118048, 126050526132804, 141629804643600,
 158940114100040, 178152655364880, 199453516332420, 223044792457760,
 249145778809200, 277994237408160, 309847743777845, 344985116783580,
 383707936014390, 426342151127100, 473239787751081, 524780754733872,
 581374757695368, 643463324051184, 711521944864290, 786062339088168,
 867634845974676, 956830951635624, 1054285955968882, 1160681786387760,
 1276749965026536, 1403274736335472, 1541096362225563, 1691114592176724,
 1854292315983250, 2031659407077300, 2224316764644975, 2433440563030400,
 2660286717211200, 2906195573424000, 3172596834321200, 3461014728350400,
 3773073433365600, 4110502764804800, 4475144139102000, 4868956823342976,
 5294024482523712, 5752562036128128, 6246922836107889, 6779606178721740,
 7353265163075118, 7970714909592876, 8634941152058949, 9349109217266832,
 10116573406743960, 10940886795441616, 11825811462719982, 12775329171405528,
 13793652511155244, 14885236522829400, 16054790821051710, 17307292232623120,
 18647997968953080, 20082459351180240, 21616536107173175, 23256411260131140,
 25008606629045130, 26879998961830820, 28877836722507435, 31009757554370400,
 33283806441690896, 35708454593072352, 38292619070202588, 41045683186360944,
 43977517699672440, 47098502826745968, 50419551102990876, 53952131116576224,
 57708292143679632, 61700689713368160, 65942612131162221, 70448007991055292,
 75231514706497318, 80308488091598364, 85695033024571425, 91408035226209520,
 97465194186982440, 103885057277142960, 110687055075051130,
 117891537949758600, 125519813934742980, 133594187930545160,
 142138002274940490, 151175678720167920, 160732761857649800,
 170835964031559216, 181513211783531667, 192793693871773748,
 204707910908793474, 217287726662965140, 230566421070146343,
 244578745002586176, 259360976843401824, 274950980915956032,
 291388267818540360, 308714056715858976, 326971339639915152,
 346204947854027808, 366461620334848584, 387790074428411200,
 410241078737424480, 433867528298218560, 458724522106970665,
 484869443056072620, 512362040342757150, 541264514413374220,
 571641604508002365, 603560678871393360, 637091827697581880,
 672307958876845200, 709284896615071686, 748101482996991032,
 788839682566134108, 831584689995826104, 876425040926973590,
 923452726049884368, 972763308508858776, 1024456044709812624,
 1078634008612735407, 1135404219592353060, 1194877773951952506,
 1257169980176935812, 1322400498016305123, 1390693481481935904,
 1462177725857175600, 1536986818808007840, 1615259295691748980,
 1697138799159994320, 1782774243154305960, 1872319981394933200,
 1965935980464679860, 2063787997591881120, 2166047763238325680,
 2272893168599857440, 2384508458129314725, 2501084427193414556,
 2622818624977164822, 2749915562751388668, 2882586927620973209,
 3021051801873509040, 3165536888050068168, 3316276739861976176,
 3473513999079569874, 3637499638521094632, 3808493211272086260,
 3986763106267800936, 4172586810373503522, 4366251177099699888,
 4568052702091702824, 4778297805535254000, 4997303121622286475,
 5225395795223303700, 5462913785915272050, 5710206179516374900,
 5967633507281457375, 6235568072914502400, 6514394287557020800,
 6804509012913811200, 7106321912680149600, 7420255812437104000,
 7746747068184336576, 8086245943682454912, 8439216996779704928,
 8806139474900561664, 9187507719876570240,
};
const uint64_t binom_K_12[] = { (206), 1, 13, 91, 455, 1820, 6188, 18564,
 50388, 125970, 293930, 646646, 1352078, 2704156, 5200300, 9657700, 17383860,
 30421755, 51895935, 86493225, 141120525, 225792840, 354817320, 548354040,
 834451800, 1251677700, 1852482996, 2707475148, 3910797436, 5586853480,
 7898654920, 11058116888, 15338678264, 21090682613, 28760021745, 38910617655,
 52251400851, 69668534468, 92263734836, 121399651100, 158753389900,
 206379406870, 266783135710, 343006888770, 438729741450, 558383307300,
 707285522580, 891794789340, 1119487075980, 1399358844975, 1742058970275,
 2160153123141, 2668424446233, 3284214703056, 4027810484880, 4922879481520,
 5996962277488, 7282025622664, 8815083648488, 10638894058520, 12802736917880,
 15363284301456, 18385569737808, 21944067106416, 26123889412400,
 31022118677225, 36749279048405, 43430966148115, 51209646652255,
 60246643120300, 70724320184700, 82848489359220, 96851050941060,
 112992892764570, 131567066917650, 152902266958350, 177366629671686,
 205371886988268, 237377895350076, 273897571557780, 315502265971620,
 362827605867363, 416579843773639, 477542747740513, 546585072715045,
 624668654531480, 712857170465336, 812325612855848, 924370524973896,
 1050421051106700, 1192050855750300, 1350990969850340, 1529143625215220,
 1728597141547640, 1951641934005400, 2200787712814600, 2478781950222760,
 2788629694000605, 3133614810784185, 3517322746798575, 3943664897925675,
 4416904685676756, 4941685440410628, 5523060198105996, 6166523522157180,
 6878045467021470, 7664107806109638, 8531742652084314, 9488573603719938,
 10542859559688820, 11703541346076580, 12980291311103116, 14383566047438588,
 15924662409664151, 17615777001840875, 19470069317824125, 21501728724901425,
 23726045489546400, 26159486052576800, 28819772769788000, 31725968343212000,
 34898565177533200, 38359579905883600, 42132653339249200, 46243156104054000,
 50718300243156000, 55587257066498976, 60881281549022688, 66633843585150816,
 72880766421258705, 79660372599980445, 87013637763055563, 94984352672648439,
 103619293824707388, 112968403041974220, 123084976448718180,
 134025863244159796, 145851674706879778, 158627003878285306,
 172420656389440550, 187305892912269950, 203360683733321660,
 220667975965944780, 239315973934897860, 259398433286078100,
 281014969393251275, 304271380653382415, 329279987282427545,
 356159986244258365, 385037822966765800, 416047580521136200,
 449331386962827096, 485039841555899448, 523332460626102036,
 564378143812462980, 608355661512135420, 655454164338881388,
 705873715441872264, 759825846558448488, 817534138702128120,
 879234828415496280, 945177440546658501, 1015625448537713793,
 1090856963244211111, 1171165451335809475, 1256860484360380900,
 1348268519586590420, 1445733713773572860, 1549618771050715820,
 1660305826125766950, 1778197364075525550, 1903717178010268530,
 2037311365940813690, 2179449368215754180, 2330625046935922100,
 2491357808793571900, 2662193772825131116, 2843706984608662783,
 3036500678480436531, 3241208589389230005, 3458496316052195145,
 3689062737122341488, 3933641482124927664, 4193002458968329488,
 4467953439884285520, 4759341707702825880, 5068055764418684856,
 5395027104058600008, 5741232051912627816, 6107693672247476400,
 6495483746675887600, 6905724825413312080, 7339592353711530640,
 7798316875818501305, 8283186318874573925, 8795548359217331075,
};
const uint64_t binom_K_13[] = { (169), 1, 14, 105, 560, 2380, 8568, 27132,
 77520, 203490, 497420, 1144066, 2496144, 5200300, 10400600, 20058300,
 37442160, 67863915, 119759850, 206253075, 347373600, 573166440, 927983760,
 1476337800, 2310789600, 3562467300, 5414950296, 8122425444, 12033222880,
 17620076360, 25518731280, 36576848168, 51915526432, 73006209045,
 101766230790, 140676848445, 192928249296, 262596783764, 354860518600,
 476260169700, 635013559600, 841392966470, 1108176102180, 1451182990950,
 1889912732400, 2448296039700, 3155581562280, 4047376351620, 5166863427600,
 6566222272575, 8308281242850, 10468434365991, 13136858812224,
 16421073515280, 20448884000160, 25371763481680, 31368725759168,
 38650751381832, 47465835030320, 58104729088840, 70907466006720,
 86270750308176, 104656320045984, 126600387152400, 152724276564800,
 183746395242025, 220495674290430, 263926640438545, 315136287090800,
 375382930211100, 446107250395800, 528955739755020, 625806790696080,
 738799683460650, 870366750378300, 1023269017336650, 1200635647008336,
 1406007533996604, 1643385429346680, 1917283000904460, 2232785266876080,
 2595612872743443, 3012192716517082, 3489735464257595, 4036320536972640,
 4660989191504120, 5373846361969456, 6186171974825304, 7110542499799200,
 8160963550905900, 9353014406656200, 10704005376506540, 12233149001721760,
 13961746143269400, 15913388077274800, 18114175790089400, 20592957740312160,
 23381587434312765, 26515202245096950, 30032524991895525, 33976189889821200,
 38393094575497956, 43334780015908584, 48857840214014580, 55024363736171760,
 61902409203193230, 69566517009302868, 78098259661387182, 87586833265107120,
 98129692824795940, 109833234170872520, 122813525481975636,
 137197091529414224, 153121753939078375, 170737530940919250,
 190207600258743375, 211709328983644800, 235435374473191200,
 261594860525768000, 290414633295556000, 322140601638768000,
 357039166816301200, 395398746722184800, 437531400061434000,
 483774556165488000, 534492856408644000, 590080113475142976,
 650961395024165664, 717595238609316480, 790476005030575185,
 870136377630555630, 957150015393611193, 1052134368066259632,
 1155753661890967020, 1268722064932941240, 1391807041381659420,
 1525832904625819216, 1671684579332698994, 1830311583210984300,
 2002732239600424850, 2190038132512694800, 2393398816246016460,
 2614066792211961240, 2853382766146859100, 3112781199432937200,
 3393796168826188475, 3698067549479570890, 4027347536761998435,
 4383507523006256800, 4768545345973022600, 5184592926494158800,
 5633924313456985896, 6118964155012885344, 6642296615638987380,
 7206674759451450360, 7815030420963585780, 8470484585302467168,
 9176358300744339432,
};
const uint64_t binom_K_14[] = { (143), 1, 15, 120, 680, 3060, 11628, 38760,
 116280, 319770, 817190, 1961256, 4457400, 9657700, 20058300, 40116600,
 77558760, 145422675, 265182525, 471435600, 818809200, 1391975640,
 2319959400, 3796297200, 6107086800, 9669554100, 15084504396, 23206929840,
 35240152720, 52860229080, 78378960360, 114955808528, 166871334960,
 239877544005, 341643774795, 482320623240, 675248872536, 937845656300,
 1292706174900, 1768966344600, 2403979904200, 3245372870670, 4353548972850,
 5804731963800, 7694644696200, 10142940735900, 13298522298180,
 17345898649800, 22512762077400, 29078984349975, 37387265592825,
 47855699958816, 60992558771040, 77413632286320, 97862516286480,
 123234279768160, 154603005527328, 193253756909160, 240719591939480,
 298824321028320, 369731787035040, 456002537343216, 560658857389200,
 687259244541600, 839983521106400, 1023729916348425, 1244225590638855,
 1508152231077400, 1823288518168200, 2198671448379300, 2644778698775100,
 3173734438530120, 3799541229226200, 4538340912686850, 5408707663065150,
 6431976680401800, 7632612327410136, 9038619861406740, 10682005290753420,
 12599288291657880, 14832073558533960, 17427686431277403, 20439879147794485,
 23929614612052080, 27965935149024720, 32626924340528840, 38000770702498296,
 44186942677323600, 51297485177122800, 59458448728028700, 68811463134684900,
 79515468511191440, 91748617512913200, 105710363656182600,
 121623751733457400, 139737927523546800, 160330885263858960,
 183712472698171725, 210227674943268675, 240260199935164200,
 274236389824985400, 312629484400483356, 355964264416391940,
 404822104630406520, 459846468366578280, 521748877569771510,
 591315394579074378, 669413654240461560, 757000487505568680,
 855130180330364620, 964963414501237140, 1087776939983212776,
 1224974031512627000, 1378095785451705375, 1548833316392624625,
 1739040916651368000, 1950750245635012800, 2186185620108204000,
 2447780480633972000, 2738195113929528000, 3060335715568296000,
 3417374882384597200, 3812773629106782000, 4250305029168216000,
 4734079585333704000, 5268572441742348000, 5858652555217490976,
 6509613950241656640, 7227209188850973120, 8017685193881548305,
 8887821571512103935,
};
const uint64_t binom_K_15[] = { (125), 1, 16, 136, 816, 3876, 15504, 54264,
 170544, 490314, 1307504, 3268760, 7726160, 17383860, 37442160, 77558760,
 155117520, 300540195, 565722720, 1037158320, 1855967520, 3247943160,
 5567902560, 9364199760, 15471286560, 25140840660, 40225345056, 63432274896,
 98672427616, 151532656696, 229911617056, 344867425584, 511738760544,
 751616304549, 1093260079344, 1575580702584, 2250829575120, 3188675231420,
 4481381406320, 6250347750920, 8654327655120, 11899700525790, 16253249498640,
 22057981462440, 29752626158640, 39895566894540, 53194089192720,
 70539987842520, 93052749919920, 122131734269895, 159518999862720,
 207374699821536, 268367258592576, 345780890878896, 443643407165376,
 566877686933536, 721480692460864, 914734449370024, 1155454041309504,
 1454278362337824, 1824010149372864, 2280012686716080, 2840671544105280,
 3527930788646880, 4367914309753280, 5391644226101705, 6635869816740560,
 8144022047817960, 9967310565986160, 12165982014365460, 14810760713140560,
 17984495151670680, 21784036380896880, 26322377293583730, 31731084956648880,
 38163061637050680, 45795673964460816, 54834293825867556, 65516299116620976,
 78115587408278856, 92947660966812816, 110375347398090219,
 130815226545884704, 154744841157936784, 182710776306961504,
 215337700647490344, 253338471349988640, 297525414027312240,
 348822899204435040, 408281347932463740, 477092811067148640,
 556608279578340080, 648356897091253280, 754067260747435880,
 875691012480893280, 1015428940004440080, 1175759825268299040,
 1359472297966470765, 1569699972909739440, 1809960172844903640,
 2084196562669889040, 2396826047070372396, 2752790311486764336,
 3157612416117170856, 3617458884483749136, 4139207762053520646,
 4730523156632595024, 5399936810873056584, 6156937298378625264,
 7012067478708989884, 7977030893210227024, 9064807833193439800,
};
const uint64_t binom_K_16[] = { (111), 1, 17, 153, 969, 4845, 20349, 74613,
 245157, 735471, 2042975, 5311735, 13037895, 30421755, 67863915, 145422675,
 300540195, 601080390, 1166803110, 2203961430, 4059928950, 7307872110,
 12875774670, 22239974430, 37711260990, 62852101650, 103077446706,
 166509721602, 265182149218, 416714805914, 646626422970, 991493848554,
 1503232609098, 2254848913647, 3348108992991, 4923689695575, 7174519270695,
 10363194502115, 14844575908435, 21094923659355, 29749251314475,
 41648951840265, 57902201338905, 79960182801345, 109712808959985,
 149608375854525, 202802465047245, 273342452889765, 366395202809685,
 488526937079580, 648045936942300, 855420636763836, 1123787895356412,
 1469568786235308, 1913212193400684, 2480089880334220, 3201570572795084,
 4116305022165108, 5271759063474612, 6726037425812436, 8550047575185300,
 10830060261901380, 13670731806006660, 17198662594653540, 21566576904406820,
 26958221130508525, 33594090947249085, 41738112995067045, 51705423561053205,
 63871405575418665, 78682166288559225, 96666661440229905, 118450697821126785,
 144773075114710515, 176504160071359395, 214667221708410075,
 260462895672870891, 315297189498738447, 380813488615359423,
 458929076023638279, 551876736990451095, 662252084388541314,
 793067310934426018, 947812152092362802, 1130522928399324306,
 1345860629046814650, 1599199100396803290, 1896724514424115530,
 2245547413628550570, 2653828761561014310, 3130921572628162950,
 3687529852206503030, 4335886749297756310, 5089954010045192190,
 5965645022526085470, 6981073962530525550, 8156833787798824590,
};
const uint64_t binom_K_17[] = { (101), 1, 18, 171, 1140, 5985, 26334, 100947,
 346104, 1081575, 3124550, 8436285, 21474180, 51895935, 119759850, 265182525,
 565722720, 1166803110, 2333606220, 4537567650, 8597496600, 15905368710,
 28781143380, 51021117810, 88732378800, 151584480450, 254661927156,
 421171648758, 686353797976, 1103068603890, 1749695026860, 2741188875414,
 4244421484512, 6499270398159, 9847379391150, 14771069086725, 21945588357420,
 32308782859535, 47153358767970, 68248282427325, 97997533741800,
 139646485582065, 197548686920970, 277508869722315, 387221678682300,
 536830054536825, 739632519584070, 1012974972473835, 1379370175283520,
 1867897112363100, 2515943049305400, 3371363686069236, 4495151581425648,
 5964720367660956, 7877932561061640, 10358022441395860, 13559593014190944,
 17675898036356052, 22947657099830664, 29673694525643100, 38223742100828400,
 49053802362729780, 62724534168736440, 79923196763389980, 101489773667796800,
 128447994798305325, 162042085745554410, 203780198740621455,
 255485622301674660, 319357027877093325, 398039194165652550,
 494705855605882455, 613156553427009240, 757929628541719755,
 934433788613079150, 1149101010321489225, 1409563905994360116,
 1724861095493098563, 2105674584108457986, 2564603660132096265,
 3116480397122547360, 3778732481511088674, 4571799792445514692,
 5519611944537877494, 6650134872937201800, 7995995501984016450,
};
const uint64_t binom_K_18[] = { (94), 1, 19, 190, 1330, 7315, 33649, 134596,
 480700, 1562275, 4686825, 13123110, 34597290, 86493225, 206253075,
 471435600, 1037158320, 2203961430, 4537567650, 9075135300, 17672631900,
 33578000610, 62359143990, 113380261800, 202112640600, 353697121050,
 608359048206, 1029530696964, 1715884494940, 2818953098830, 4568648125690,
 7309837001104, 11554258485616, 18053528883775, 27900908274925,
 42671977361650, 64617565719070, 96926348578605, 144079707346575,
 212327989773900, 310325523515700, 449972009097765, 647520696018735,
 925029565741050, 1312251244423350, 1849081298960175, 2588713818544245,
 3601688791018080, 4981058966301600, 6848956078664700, 9364899127970100,
 12736262814039336, 17231414395464984, 23196134763125940, 31074067324187580,
 41432089765583440, 54991682779774384, 72667580816130436, 95615237915961100,
 125288932441604200, 163512674542432600, 212566476905162380,
 275291011073898820, 355214207837288800, 456703981505085600,
 585151976303390925, 747194062048945335, 950974260789566790,
 1206459883091241450, 1525816910968334775, 1923856105133987325,
 2418561960739869780, 3031718514166879020, 3789648142708598775,
 4724081931321677925, 5873182941643167150, 7282746847637527266,
 9007607943130625829,
};
const uint64_t binom_K_19[] = { (88), 1, 20, 210, 1540, 8855, 42504, 177100,
 657800, 2220075, 6906900, 20030010, 54627300, 141120525, 347373600,
 818809200, 1855967520, 4059928950, 8597496600, 17672631900, 35345263800,
 68923264410, 131282408400, 244662670200, 446775310800, 800472431850,
 1408831480056, 2438362177020, 4154246671960, 6973199770790, 11541847896480,
 18851684897584, 30405943383200, 48459472266975, 76360380541900,
 119032357903550, 183649923622620, 280576272201225, 424655979547800,
 636983969321700, 947309492837400, 1397281501935165, 2044802197953900,
 2969831763694950, 4282083008118300, 6131164307078475, 8719878125622720,
 12321566916640800, 17302625882942400, 24151581961607100, 33516481089577200,
 46252743903616536, 63484158299081520, 86680293062207460, 117754360386395040,
 159186450151978480, 214178132931752864, 286845713747883300,
 382460951663844400, 507749884105448600, 671262558647881200,
 883829035553043580, 1159120046626942400, 1514334254464231200,
 1971038235969316800, 2556190212272707725, 3303384274321653060,
 4254358535111219850, 5460818418202461300, 6986635329170796075,
 8910491434304783400,
};
const uint64_t binom_K_20[] = { (83), 1, 21, 231, 1771, 10626, 53130, 230230,
 888030, 3108105, 10015005, 30045015, 84672315, 225792840, 573166440,
 1391975640, 3247943160, 7307872110, 15905368710, 33578000610, 68923264410,
 137846528820, 269128937220, 513791607420, 960566918220, 1761039350070,
 3169870830126, 5608233007146, 9762479679106, 16735679449896, 28277527346376,
 47129212243960, 77535155627160, 125994627894135, 202355008436035,
 321387366339585, 505037289962205, 785613562163430, 1210269541711230,
 1847253511032930, 2794563003870330, 4191844505805495, 6236646703759395,
 9206478467454345, 13488561475572645, 19619725782651120, 28339603908273840,
 40661170824914640, 57963796707857040, 82115378669464140, 115631859759041340,
 161884603662657876, 225368761961739396, 312049055023946856,
 429803415410341896, 588989865562320376, 803167998494073240,
 1090013712241956540, 1472474663905800940, 1980224548011249540,
 2651487106659130740, 3535316142212174320, 4694436188839116720,
 6208770443303347920, 8179808679272664720,
};
const uint64_t binom_K_21[] = { (79), 1, 22, 253, 2024, 12650, 65780, 296010,
 1184040, 4292145, 14307150, 44352165, 129024480, 354817320, 927983760,
 2319959400, 5567902560, 12875774670, 28781143380, 62359143990, 131282408400,
 269128937220, 538257874440, 1052049481860, 2012616400080, 3773655750150,
 6943526580276, 12551759587422, 22314239266528, 39049918716424,
 67327446062800, 114456658306760, 191991813933920, 317986441828055,
 520341450264090, 841728816603675, 1346766106565880, 2132379668729310,
 3342649210440540, 5189902721473470, 7984465725343800, 12176310231149295,
 18412956934908690, 27619435402363035, 41107996877935680, 60727722660586800,
 89067326568860640, 129728497393775280, 187692294101632320,
 269807672771096460, 385439532530137800, 547324136192795676,
 772692898154535072, 1084741953178481928, 1514545368588823824,
 2103535234151144200, 2906703232645217440, 3996716944887173980,
 5469191608792974920, 7449416156804224460,
};
const uint64_t binom_K_22[] = { (76), 1, 23, 276, 2300, 14950, 80730, 376740,
 1560780, 5852925, 20160075, 64512240, 193536720, 548354040, 1476337800,
 3796297200, 9364199760, 22239974430, 51021117810, 113380261800,
 244662670200, 513791607420, 1052049481860, 2104098963720, 4116715363800,
 7890371113950, 14833897694226, 27385657281648, 49699896548176,
 88749815264600, 156077261327400, 270533919634160, 462525733568080,
 780512175396135, 1300853625660225, 2142582442263900, 3489348548829780,
 5621728217559090, 8964377427999630, 14154280149473100, 22138745874816900,
 34315056105966195, 52728013040874885, 80347448443237920, 121455445321173600,
 182183167981760400, 271250494550621040, 400978991944396320,
 588671286046028640, 858478958817125100, 1243918491347262900,
 1791242627540058576, 2563935525694593648, 3648677478873075576,
 5163222847461899400, 7266758081613043600,
};
const uint64_t binom_K_23[] = { (74), 1, 24, 300, 2600, 17550, 98280, 475020,
 2035800, 7888725, 28048800, 92561040, 286097760, 834451800, 2310789600,
 6107086800, 15471286560, 37711260990, 88732378800, 202112640600,
 446775310800, 960566918220, 2012616400080, 4116715363800, 8233430727600,
 16123801841550, 30957699535776, 58343356817424, 108043253365600,
 196793068630200, 352870329957600, 623404249591760, 1085929983159840,
 1866442158555975, 3167295784216200, 5309878226480100, 8799226775309880,
 14420954992868970, 23385332420868600, 37539612570341700, 59678358445158600,
 93993414551124795, 146721427591999680, 227068876035237600,
 348524321356411200, 530707489338171600, 801957983888792640,
 1202936975833188960, 1791608261879217600, 2650087220696342700,
 3894005712043605600, 5685248339583664176, 8249183865278257824,
};
const uint64_t binom_K_24[] = { (72), 1, 25, 325, 2925, 20475, 118755,
 593775, 2629575, 10518300, 38567100, 131128140, 417225900, 1251677700,
 3562467300, 9669554100, 25140840660, 62852101650, 151584480450,
 353697121050, 800472431850, 1761039350070, 3773655750150, 7890371113950,
 16123801841550, 32247603683100, 63205303218876, 121548660036300,
 229591913401900, 426384982032100, 779255311989700, 1402659561581460,
 2488589544741300, 4355031703297275, 7522327487513475, 12832205713993575,
 21631432489303455, 36052387482172425, 59437719903041025, 96977332473382725,
 156655690918541325, 250649105469666120, 397370533061665800,
 624439409096903400, 972963730453314600, 1503671219791486200,
 2305629203680278840, 3508566179513467800, 5300174441392685400,
 7950261662089028100,
};
const uint64_t binom_K_25[] = { (70), 1, 26, 351, 3276, 23751, 142506,
 736281, 3365856, 13884156, 52451256, 183579396, 600805296, 1852482996,
 5414950296, 15084504396, 40225345056, 103077446706, 254661927156,
 608359048206, 1408831480056, 3169870830126, 6943526580276, 14833897694226,
 30957699535776, 63205303218876, 126410606437752, 247959266474052,
 477551179875952, 903936161908052, 1683191473897752, 3085851035479212,
 5574440580220512, 9929472283517787, 17451799771031262, 30284005485024837,
 51915437974328292, 87967825456500717, 147405545359541742,
 244382877832924467, 401038568751465792, 651687674221131912,
 1049058207282797712, 1673497616379701112, 2646461346833015712,
 4150132566624501912, 6455761770304780752,
};
const uint64_t binom_K_26[] = { (69), 1, 27, 378, 3654, 27405, 169911,
 906192, 4272048, 18156204, 70607460, 254186856, 854992152, 2707475148,
 8122425444, 23206929840, 63432274896, 166509721602, 421171648758,
 1029530696964, 2438362177020, 5608233007146, 12551759587422, 27385657281648,
 58343356817424, 121548660036300, 247959266474052, 495918532948104,
 973469712824056, 1877405874732108, 3560597348629860, 6646448384109072,
 12220888964329584, 22150361247847371, 39602161018878633, 69886166503903470,
 121801604478231762, 209769429934732479, 357174975294274221,
 601557853127198688, 1002596421878664480, 1654284096099796392,
 2703342303382594104, 4376839919762295216, 7023301266595310928,
};
const uint64_t binom_K_27[] = { (68), 1, 28, 406, 4060, 31465, 201376,
 1107568, 5379616, 23535820, 94143280, 348330136, 1203322288, 3910797436,
 12033222880, 35240152720, 98672427616, 265182149218, 686353797976,
 1715884494940, 4154246671960, 9762479679106, 22314239266528, 49699896548176,
 108043253365600, 229591913401900, 477551179875952, 973469712824056,
 1946939425648112, 3824345300380220, 7384942649010080, 14031391033119152,
 26252279997448736, 48402641245296107, 88004802264174740, 157890968768078210,
 279692573246309972, 489462003181042451, 846636978475316672,
 1448194831602515360, 2450791253481179840, 4105075349580976232,
 6808417652963570336,
};
const uint64_t binom_K_28[] = { (67), 1, 29, 435, 4495, 35960, 237336,
 1344904, 6724520, 30260340, 124403620, 472733756, 1676056044, 5586853480,
 17620076360, 52860229080, 151532656696, 416714805914, 1103068603890,
 2818953098830, 6973199770790, 16735679449896, 39049918716424,
 88749815264600, 196793068630200, 426384982032100, 903936161908052,
 1877405874732108, 3824345300380220, 7648690600760440, 15033633249770520,
 29065024282889672, 55317304280338408, 103719945525634515,
 191724747789809255, 349615716557887465, 629308289804197437,
 1118770292985239888, 1965407271460556560, 3413602103063071920,
 5864393356544251760,
};
const uint64_t binom_K_29[] = { (67), 1, 30, 465, 4960, 40920, 278256,
 1623160, 8347680, 38608020, 163011640, 635745396, 2311801440, 7898654920,
 25518731280, 78378960360, 229911617056, 646626422970, 1749695026860,
 4568648125690, 11541847896480, 28277527346376, 67327446062800,
 156077261327400, 352870329957600, 779255311989700, 1683191473897752,
 3560597348629860, 7384942649010080, 15033633249770520, 30067266499541040,
 59132290782430712, 114449595062769120, 218169540588403635,
 409894288378212890, 759510004936100355, 1388818294740297792,
 2507588587725537680, 4472995859186094240, 7886597962249166160,
};
const uint64_t binom_K_30[] = { (66), 1, 31, 496, 5456, 46376, 324632,
 1947792, 10295472, 48903492, 211915132, 847660528, 3159461968, 11058116888,
 36576848168, 114955808528, 344867425584, 991493848554, 2741188875414,
 7309837001104, 18851684897584, 47129212243960, 114456658306760,
 270533919634160, 623404249591760, 1402659561581460, 3085851035479212,
 6646448384109072, 14031391033119152, 29065024282889672, 59132290782430712,
 118264581564861424, 232714176627630544, 450883717216034179,
 860778005594247069, 1620288010530347424, 3009106305270645216,
 5516694892996182896,
};
const uint64_t binom_K_31[] = { (66), 1, 32, 528, 5984, 52360, 376992,
 2324784, 12620256, 61523748, 273438880, 1121099408, 4280561376, 15338678264,
 51915526432, 166871334960, 511738760544, 1503232609098, 4244421484512,
 11554258485616, 30405943383200, 77535155627160, 191991813933920,
 462525733568080, 1085929983159840, 2488589544741300, 5574440580220512,
 12220888964329584, 26252279997448736, 55317304280338408, 114449595062769120,
 232714176627630544, 465428353255261088, 916312070471295267,
 1777090076065542336, 3397378086595889760, 6406484391866534976,
};
const uint64_t binom_K_32[] = { (66), 1, 33, 561, 6545, 58905, 435897,
 2760681, 15380937, 76904685, 350343565, 1471442973, 5752004349, 21090682613,
 73006209045, 239877544005, 751616304549, 2254848913647, 6499270398159,
 18053528883775, 48459472266975, 125994627894135, 317986441828055,
 780512175396135, 1866442158555975, 4355031703297275, 9929472283517787,
 22150361247847371, 48402641245296107, 103719945525634515,
 218169540588403635, 450883717216034179, 916312070471295267,
 1832624140942590534, 3609714217008132870, 7007092303604022630,
};
const uint64_t binom_K_33[] = { (66), 1, 34, 595, 7140, 66045, 501942,
 3262623, 18643560, 95548245, 445891810, 1917334783, 7669339132, 28760021745,
 101766230790, 341643774795, 1093260079344, 3348108992991, 9847379391150,
 27900908274925, 76360380541900, 202355008436035, 520341450264090,
 1300853625660225, 3167295784216200, 7522327487513475, 17451799771031262,
 39602161018878633, 88004802264174740, 191724747789809255,
 409894288378212890, 860778005594247069, 1777090076065542336,
 3609714217008132870, 7219428434016265740,
};

static const uint64_t * binom_K_N[] =
{
  0, 0, 0, 0, 0, 0, 0, 0,   // K=0-7 handled above
  binom_K_8,  binom_K_9,  binom_K_10, binom_K_11, binom_K_12, binom_K_13, 
  binom_K_14, binom_K_15, binom_K_16, binom_K_17, binom_K_18, binom_K_19, 
  binom_K_20, binom_K_21, binom_K_22, binom_K_23, binom_K_24, binom_K_25, 
  binom_K_26, binom_K_27, binom_K_28, binom_K_29, binom_K_30, binom_K_31, 
  binom_K_32, binom_K_33, 
};

void
NumericCell::do_binomial(Cell * Z, APL_Integer K, APL_Integer N, bool negate)
{
   Assert(N >= K);
   Assert(K >= 0);

   // make K < N/2 (or: K < N-K)
   //
   if (K > (N - K))   K = N - K;

   // for small K, the max N gets very large. We handle these cases
   // separately in order to have a small max_N for integer results.
   //
   if (K <= 7)
      {
        APL_Integer z;
        if (K == 0)
           {
             z = 1;
           }
        else if (K == 1)
           {
             z = N;
           }
        else if (K == 2)   // K == 2 or N-2
           {
             if (N > 4294967296)   goto non_integer;   // K!N too large

             // either N or N-1 must be even
             //
             if (N & 1)   // N-1 even: divide N-1
                {
                  z = N * ((N-1)/2);
                }
             else         // N even: divide N-1
                {
                  z = (N - 1) * (N/2);
                }
           }
        else if (K == 3)   // K == 3 or N-3
           {
             if (N > 3810779)   goto non_integer;   // K!N too large

             APL_Integer N0 = N;
             APL_Integer N1 = N - 1;
             APL_Integer N2 = N - 2;

             if (N0 & 1)   N1 = N1/2;
             else          N0 = N0/2;

             if      ((N0 % 3) == 0)   N0 = N0/3;
             else if ((N1 % 3) == 0)   N1 = N1/3;
             else                      N2 = N2/3;
             z = N0 * N1 * N2;
           }
        else if (K == 4)   // K == 4 or N-4
           {
             if (N > 121977)   goto non_integer;   // K!N too large

             APL_Integer N0 = N;
             APL_Integer N1 = N - 1;
             APL_Integer N2 = N - 2;
             APL_Integer N3 = N - 3;

             for (int j = 0; j < 3; ++j)
                 {
                   if      ((N0 & 1) == 0)   N0 = N0/2;
                   else if ((N1 & 1) == 0)   N1 = N1/2;
                   else if ((N2 & 1) == 0)   N2 = N2/2;
                   else                      N3 = N3/2;
                 }

             if      ((N0 % 3) == 0)   N0 = N0/3;
             else if ((N1 % 3) == 0)   N1 = N1/3;
             else                      N2 = N2/3;

             z = N0 * N1 * N2 * N3;
           }
        else if (K == 5)   // K == 5 or N-5
           {
             if (N > 16175)   goto non_integer;   // K!N too large

             APL_Integer N0 = N;
             APL_Integer N1 = N - 1;
             APL_Integer N2 = N - 2;
             APL_Integer N3 = N - 3;
             APL_Integer N4 = N - 4;

             for (int j = 0; j < 3; ++j)
                 {
                   if      ((N0 & 1) == 0)   N0 = N0/2;
                   else if ((N1 & 1) == 0)   N1 = N1/2;
                   else if ((N2 & 1) == 0)   N2 = N2/2;
                   else if ((N3 & 1) == 0)   N3 = N3/2;
                   else                      N4 = N4/2;
                 }

             if      ((N0 % 3) == 0)   N0 = N0/3;
             else if ((N1 % 3) == 0)   N1 = N1/3;
             else                      N2 = N2/3;

             if      ((N0 % 5) == 0)   N0 = N0/5;
             else if ((N1 % 5) == 0)   N1 = N1/5;
             else if ((N2 % 5) == 0)   N2 = N2/5;
             else if ((N3 % 5) == 0)   N3 = N3/5;
             else                      N4 = N4/5;

             z = N0 * N1 * N2 * N3 * N4;
           }
        else if (K == 6)   // K == 6 or N-6
           {
             if (N > 4337)   goto non_integer;   // K!N too large

             APL_Integer N0 = N;
             APL_Integer N1 = N - 1;
             APL_Integer N2 = N - 2;
             APL_Integer N3 = N - 3;
             APL_Integer N4 = N - 4;
             APL_Integer N5 = N - 5;

             for (int j = 0; j < 4; ++j)
                 {
                   if      ((N0 & 1) == 0)   N0 = N0/2;
                   else if ((N1 & 1) == 0)   N1 = N1/2;
                   else if ((N2 & 1) == 0)   N2 = N2/2;
                   else if ((N3 & 1) == 0)   N3 = N3/2;
                   else if ((N4 & 1) == 0)   N4 = N4/2;
                   else                      N5 = N5/2;
                 }

             for (int j = 0; j < 2; ++j)
                 {
                   if      ((N0 % 3) == 0)   N0 = N0/3;
                   else if ((N1 % 3) == 0)   N1 = N1/3;
                   else if ((N2 % 3) == 0)   N2 = N2/3;
                   else if ((N3 % 3) == 0)   N3 = N3/3;
                   else if ((N4 % 3) == 0)   N4 = N4/3;
                   else                      N5 = N5/3;
                 }

             if      ((N0 % 5) == 0)   N0 = N0/5;
             else if ((N1 % 5) == 0)   N1 = N1/5;
             else if ((N2 % 5) == 0)   N2 = N2/5;
             else if ((N3 % 5) == 0)   N3 = N3/5;
             else if ((N4 % 5) == 0)   N4 = N4/5;
             else                      N5 = N5/5;

             z = N0 * N1 * N2 * N3 * N4 * N5;
           }
        else if (K == 7)   // K == 7 or N-7
           {
             if (N > 1733)   goto non_integer;   // K!N too large

             APL_Integer N0 = N;
             APL_Integer N1 = N - 1;
             APL_Integer N2 = N - 2;
             APL_Integer N3 = N - 3;
             APL_Integer N4 = N - 4;
             APL_Integer N5 = N - 5;
             APL_Integer N6 = N - 6;

             for (int j = 0; j < 4; ++j)
                 {
                   if      ((N0 & 1) == 0)   N0 = N0/2;
                   else if ((N1 & 1) == 0)   N1 = N1/2;
                   else if ((N2 & 1) == 0)   N2 = N2/2;
                   else if ((N3 & 1) == 0)   N3 = N3/2;
                   else if ((N4 & 1) == 0)   N4 = N4/2;
                   else if ((N5 & 1) == 0)   N5 = N5/2;
                   else                      N6 = N6/2;
                 }

             for (int j = 0; j < 2; ++j)
                 {
                   if      ((N0 % 3) == 0)   N0 = N0/3;
                   else if ((N1 % 3) == 0)   N1 = N1/3;
                   else if ((N2 % 3) == 0)   N2 = N2/3;
                   else if ((N3 % 3) == 0)   N3 = N3/3;
                   else if ((N4 % 3) == 0)   N4 = N4/3;
                   else if ((N5 % 3) == 0)   N5 = N5/3;
                   else                      N6 = N6/3;
                 }

             if      ((N0 % 5) == 0)   N0 = N0/5;
             else if ((N1 % 5) == 0)   N1 = N1/5;
             else if ((N2 % 5) == 0)   N2 = N2/5;
             else if ((N3 % 5) == 0)   N3 = N3/5;
             else if ((N4 % 5) == 0)   N4 = N4/5;
             else if ((N5 % 5) == 0)   N5 = N5/5;
             else                      N6 = N6/5;

             if      ((N0 % 7) == 0)   N0 = N0/7;
             else if ((N1 % 7) == 0)   N1 = N1/7;
             else if ((N2 % 7) == 0)   N2 = N2/7;
             else if ((N3 % 7) == 0)   N3 = N3/7;
             else if ((N4 % 7) == 0)   N4 = N4/7;
             else if ((N5 % 7) == 0)   N5 = N5/7;
             else                      N6 = N6/7;

             z = N0 * N1 * N2 * N3 * N4 * N5 *N6;
           }

        if (negate)   new (Z) IntCell(-z);
        else          new (Z) IntCell( z);
        return;
      }

   // at this point, K >= 8. If K â¤ 33 then we try a table lookup.
   // That may for small N (and give a more precise interger result if so).
   //
   if (K <= 33)
      {
        const uint64_t * table_K = binom_K_N[K];
        Assert(table_K);

        // the first element in the table is the max. N (including) for K
        //
        if (N <= table_K[0])
           {
             const APL_Integer z = table_K[1 + (N - K)];
             if (negate)   new (Z) IntCell(-z);
             else          new (Z) IntCell( z);
             return;
           }
      }

non_integer:

   // at this point, the result is too large for an APL_Integer
   // N! fits into double for N â¤ 170
   //
   if (N > 170)   DOMAIN_ERROR;

double z  = tgamma(N + 1);          // N!
       z /= tgamma(K + 1);          // Ã· K!
       z /= tgamma((N - K) + 1);    // Ã· (N-K)!

   new (Z) FloatCell(z);
}
//-----------------------------------------------------------------------------
ErrorCode
NumericCell::bif_binomial(Cell * Z, const Cell * A) const
{
const APL_Float qct = Workspace::get_CT();
   if (!is_near_real(qct) || !A->is_near_real(qct))   // complex result
      {
        const APL_Float r_1_a    = A->get_real_value();
        const APL_Float r_1_b    = get_real_value();
        const APL_Float r_1_b__a = r_1_b - A->get_real_value();

        const APL_Float i_a   = A->get_imag_value();
        const APL_Float i_b   = get_imag_value();
        const APL_Float i_b_a = i_b - i_a;

        const APL_Complex gam_1_a    = ComplexCell::gamma(r_1_a,    i_a);
        const APL_Complex gam_1_b    = ComplexCell::gamma(r_1_b,    i_b);
        const APL_Complex gam_1_b__a = ComplexCell::gamma(r_1_b__a, i_b_a);

        new (Z) ComplexCell(gam_1_b / (gam_1_a * gam_1_b__a));
        return E_NO_ERROR;
      }

   if (!is_near_int(qct) || !A->is_near_int(qct))   // non-integer result
      {
        const APL_Float r_1_a    = 1.0 + A->get_real_value();
        const APL_Float r_1_b    = 1.0 + get_real_value();
        const APL_Float r_1_b__a = r_1_b - A->get_real_value();

        if (r_1_a < 0    && is_near_int(r_1_a, qct))      return E_DOMAIN_ERROR;
        if (r_1_b < 0    && is_near_int(r_1_b, qct))      return E_DOMAIN_ERROR;
        if (r_1_b__a < 0 && is_near_int(r_1_b__a, qct))   return E_DOMAIN_ERROR;

        new (Z) FloatCell(  tgamma(r_1_b) / (tgamma(r_1_a) * tgamma(r_1_b__a)));
        return E_NO_ERROR;
      }

const APL_Integer a = A->get_near_int(qct);
const APL_Integer b = get_near_int(qct);

int how = 0;
   if (a < 0)    how |= 4;
   if (b < 0)    how |= 2;
   if (b < a)    how |= 1;

   switch(how)
      {
        case 0: do_binomial(Z, a, b, false);                       break;
        case 1: new (Z) IntCell(0);                                break;
        case 2: Assert(0 && "Impossible case 2");                  break;
        case 3: do_binomial(Z, a, a - (b + 1), a & 1);             break;
        case 4: new (Z) IntCell(0);                                break;
        case 5: Assert(0 && "Impossible case 5");                  break;
        case 6: do_binomial(Z, -(b + 1), -(a + 1), (b - a) & 1);   break;
        case 7: new (Z) IntCell(0);                                break;
      }

   return E_NO_ERROR;
}
//-----------------------------------------------------------------------------
ErrorCode
NumericCell::bif_and(Cell * Z, const Cell * A) const
{
const APL_Float qct = Workspace::get_CT();

   // if either value is 0 then return 0
   //
   if (A->is_near_zero(qct) || is_near_zero(qct))
      {
        new (Z) IntCell(0);
        return E_NO_ERROR;
      }

   // if both args are 1 then return the classical A â§ B
   //
   if (A->is_near_one(qct) && is_near_one(qct))
      {
        new (Z) IntCell(1);
        return E_NO_ERROR;
      }

   // handle the complex case before the int case because
   // is_near_int() can be true for complex numbers.
   //
   if (A->is_complex_cell() || is_complex_cell())   // complex
      {
        // a or b is complex; we assume (require) Gaussian integers.
        //
        APL_Complex gcd;
        const ErrorCode err = cpx_gcd(gcd, A->get_complex_value(),
                                           get_complex_value(), qct);
        if (err)   return err;

        new (Z) ComplexCell(A->get_complex_value() * (get_complex_value()/gcd));
        return E_NO_ERROR;
      }

   // if both args are int then return the least common multiple of them
   //
   if (A->is_near_int(qct) && is_near_int(qct))
      {
        const APL_Integer a = A->get_near_int(qct);
        const APL_Integer b =    get_near_int(qct);
        APL_Integer gcd;
        const ErrorCode err = int_gcd(gcd, a, b);
        if (err)   return err;
        new (Z) IntCell(a * (b / gcd));
        return E_NO_ERROR;
      }

   // if both args are real then return the (real) least common multiple of them
   //
   if (A->is_near_real(qct) && is_near_real(qct))
      {
        const APL_Float a = A->get_real_value();
        const APL_Float b =    get_real_value();
        APL_Float gcd;
        const ErrorCode err = flt_gcd(gcd, a, b, qct);
        if (err)   return err;
        new (Z) FloatCell(a * (b / gcd));
        return E_NO_ERROR;
      }

   return E_DOMAIN_ERROR;   // char ?
}
//-----------------------------------------------------------------------------
ErrorCode
NumericCell::bif_nand(Cell * Z, const Cell * A) const
{
const APL_Float qct = Workspace::get_CT();
   if ( A->get_near_bool(qct) && get_near_bool(qct))   new (Z) IntCell(0);
   else                                                new (Z) IntCell(1);
   return E_NO_ERROR;
}
//-----------------------------------------------------------------------------
ErrorCode
NumericCell::bif_nor(Cell * Z, const Cell * A) const
{
const APL_Float qct = Workspace::get_CT();
   if ( A->get_near_bool(qct) || get_near_bool(qct))   new (Z) IntCell(0);
   else                                                new (Z) IntCell(1);
   return E_NO_ERROR;
}
//-----------------------------------------------------------------------------
ErrorCode
NumericCell::bif_or(Cell * Z, const Cell * A) const
{
const APL_Float qct = Workspace::get_CT();

   // if both args are boolean then return the classical A â¨ B
   //
   if (A->is_near_bool(qct) && is_near_bool(qct))
      {
        if ( A->get_near_bool(qct) || get_near_bool(qct))   new (Z) IntCell(1);
        else                                                new (Z) IntCell(0);
        return E_NO_ERROR;
      }

   if (!A->is_near_real(qct) || !is_near_real(qct))   // complex
      {
        if (A->is_near_zero(qct))
           {
             new (Z) ComplexCell(get_complex_value());
             return E_NO_ERROR;
           }

        if (is_near_zero(qct))
           {
             new (Z) ComplexCell(A->get_complex_value());
             return E_NO_ERROR;
           }

        // a or b is complex; we assume (require) Gaussian integers.
        //
        APL_Complex gcd;
        const ErrorCode err = cpx_gcd(gcd, A->get_complex_value(),
                                           get_complex_value(), qct);
        if (err)   return err;

        new (Z) ComplexCell(gcd);
        return E_NO_ERROR;
      }

   // if both args are int then return the greatest common divisor of them
   //
   if (A->is_near_int(qct) && is_near_int(qct))
      {
        const APL_Integer a = A->get_near_int(qct);
        const APL_Integer b =    get_near_int(qct);
        APL_Integer gcd;
        const ErrorCode err = int_gcd(gcd, a, b);
        if (err)   return err;
        new (Z) IntCell(gcd);
        return E_NO_ERROR;
      }

   // if both args are real then return the (real) greatest common divisor
   //
   if (A->is_near_real(qct) && is_near_real(qct))
      {
        const APL_Float a = A->get_real_value();
        const APL_Float b =    get_real_value();
        APL_Float gcd;
        const ErrorCode err = flt_gcd(gcd, a, b, qct);
        if (err)   return err;
        new (Z) FloatCell(gcd);
        return E_NO_ERROR;
      }

   return E_DOMAIN_ERROR;   // char ?
}
//-----------------------------------------------------------------------------
APL_Complex
NumericCell::cpx_max_real(APL_Complex a)
{
const double r_abs = a.real() < 0 ? -a.real() : a.real();
const double i_abs = a.imag() < 0 ? -a.imag() : a.imag();
APL_Complex z;

   if (r_abs < i_abs)   // multiply by i in order to exchange real and imag
      {
        z = APL_Complex(- a.imag(), a.real());
     }
   else
      {
        z = a;
     }

   if (z.real() < 0)   // multiply by -1 in order to make z.real positive
      {
        z = APL_Complex(- z.real(), - z.imag());
      }

   return z;
}
//-----------------------------------------------------------------------------
ErrorCode
NumericCell::int_gcd(APL_Integer & z, APL_Integer a, APL_Integer b)
{
   if (a == 0x8000000000000000ULL)   return E_DOMAIN_ERROR;
   if (b == 0x8000000000000000ULL)   return E_DOMAIN_ERROR;

   if (a < 0)   a = - a;
   if (b < 0)   b = - b;
   if (b < a)
      {
         const APL_Integer _b = b;
         b = a;
         a = _b;
      }

   // at this point 0 â¤ a â¤ b
   //
   for (;;)
       {
         if (a == 0)   { z = b;   return E_NO_ERROR; }
         const APL_Integer r = b%a;
         b = a;
         a = r;
       }
}
//-----------------------------------------------------------------------------
ErrorCode
NumericCell::flt_gcd(APL_Float & z, APL_Float a, APL_Float b, APL_Float qct)
{
   if (a < 0)   a = - a;
   if (b < 0)   b = - b;
   if (b < a)
      {
         const APL_Float _b = b;
         b = a;
         a = _b;
      }

   // at this point 0 â¤ a â¤ b
   //
   for (;;)
       {
         if (is_near_zero(a, qct))   { z = b;   return E_NO_ERROR; }
         const APL_Float r = fmod(b, a);
         b = a;
         a = r;
       }
}
//-----------------------------------------------------------------------------
ErrorCode
NumericCell::cpx_gcd(APL_Complex & z, APL_Complex a, APL_Complex b,
                     APL_Float qct)
{
   if (!is_near_int(a.real(), qct))   return E_DOMAIN_ERROR;
   if (!is_near_int(a.imag(), qct))   return E_DOMAIN_ERROR;
   if (!is_near_int(b.real(), qct))   return E_DOMAIN_ERROR;
   if (!is_near_int(b.imag(), qct))   return E_DOMAIN_ERROR;

   // make a and b true integers
   //
   a = APL_Complex(round(a.real()), a.imag());
   b = APL_Complex(round(b.real()), b.imag());

   for (;;)
       {
         if (abs(a) > abs(b))   // make â£bâ£ > â£aâ£
            {
               const APL_Complex _b = b;
               b = a;
               a = _b;
            }

         if (abs(a) < 0.2)   { z = b;   return E_NO_ERROR; }

         const APL_Complex xy = b/a;
         const APL_Complex q(round(xy.real()), round(xy.imag()));
         const APL_Complex r(b - q*a);

         b = a;
         a = r;
       }
}
//-----------------------------------------------------------------------------
